<head>
  <meta charset="UTF-8" />
  <title>Embed Player - eBay Channel</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
</head>

<body>
  <iframe
    id="vimmi-player"
    src="https://embed-player.dev-shoprz.live/?appId=65d8c4b5b54e13d4ebac066a&store=bacardi.dev-shoprz.live&player=channel-embedded-player_995878&targetId=660c2e1bb43ece5f8828e609"
    frameborder="0"
    width="100%"
    height="100%"
    allowfullscreen
    allow="autoplay; fullscreen; picture-in-picture; encrypted-media;"
  ></iframe>
  <script>
    !(function () {
      var e;
      if (window.PLAYER_MANAGER) return;
      (this.debug = !0),
        (window.PLAYER_MANAGER = this),
        this.activePlayer,
        (this.instances = []);
      let i = this;
      function s() {
        window.PLAYER_MANAGER.debug &&
          console.log("[PlayerManager]", ...arguments);
      }
      function t(e) {
        if (!e) return !1;
        let i = e.getBoundingClientRect(),
          s = window.innerHeight || document.documentElement.clientHeight,
          t = window.innerWidth || document.documentElement.clientWidth,
          a = Math.min(i.right, t) - Math.max(i.left, 0),
          n = Math.min(i.bottom, s) - Math.max(i.top, 0),
          l = i.width * i.height;
        return (a > 0 && n > 0 ? a * n : 0) >= 0.1 * l;
      }
      function a(e, i, a = "*") {
        let n = { ...e, source: "player-manager" };
        s("[iframe][sendPM]", n, i),
          (e.isInViewport = t(i)),
          i.contentWindow.postMessage(JSON.stringify(n), a);
      }
      function n(e, i) {
        let s = {};
        for (let t in i) (s[t] = e.style[t]), (e.style[t] = i[t]);
        return s;
      }
      let l = async () => {
          let e = await new Promise((e) => {
            let i = 0,
              s = () => {
                i > 1e4 && e(!1),
                  window.SimplePlayer
                    ? e(!0)
                    : ((i += 200), setTimeout(s, 200));
              };
            window.SimplePlayer ? e(!0) : ((i += 200), setTimeout(s, 200));
          });
          if (e) {
            s("[simple]", "found simple player");
            let i = (e) => {
                let i = {
                  playOnlyWhenVisible: !0,
                  isUserPaused: !1,
                  player: e,
                  uuid: Math.random().toString(36).substring(7),
                  play() {
                    e.play();
                  },
                  pause() {
                    e.pause();
                  },
                  isPaused: () => e.isPaused(),
                  isInViewport: () => e.isInViewport(),
                };
                this.instances.push(i),
                  (function e(i) {
                    let t = i.player;
                    (i.playOnlyWhenVisible = t.getConf().playOnlyWhenVisible),
                      t.on("play", () => {
                        (i.playOnlyWhenVisible =
                          t.getConf().playOnlyWhenVisible),
                          i.isInViewport()
                            ? (this.activePlayer &&
                                this.activePlayer !== i &&
                                this.activePlayer.pause(),
                              (this.activePlayer = i))
                            : t.pause(),
                          s("[simple]", "play", i);
                      }),
                      t.on("pause", () => {
                        (i.playOnlyWhenVisible =
                          t.getConf().playOnlyWhenVisible),
                          (this.activePlayer = null),
                          s("[simple]", "pause", i);
                      }),
                      t.on("timeupdate", () => {
                        (i.playOnlyWhenVisible =
                          t.getConf().playOnlyWhenVisible),
                          i.isPaused() ||
                            !i.playOnlyWhenVisible ||
                            i.isInViewport() ||
                            (t.pause(), (this.activePlayer = null));
                      }),
                      t.on("user:play", () => {
                        (i.playOnlyWhenVisible =
                          t.getConf().playOnlyWhenVisible),
                          (i.isUserPaused = !1),
                          s("[simple]", "user:play", i);
                      }),
                      t.on("user:pause", () => {
                        (i.isUserPaused = !0),
                          (this.activePlayer = null),
                          s("[simple]", "user:pause", i);
                      });
                  })(i),
                  s("[simple][onPlayerBind]", e, this.instances);
              },
              t = (e) => {
                (this.instances = this.instances.filter((i) => i.player !== e)),
                  s("[simple][onPlayerUnBind]", e, this.instances);
              };
            window.SimplePlayer.on("player:bind", (e) => {
              i(e.detail);
            }),
              window.SimplePlayer.on("player:unbind", (e) => {
                t(e.detail);
              }),
              window.SimplePlayer.instances.forEach((e) => {
                i(e);
              });
          } else s("[simple]", "simple player not found");
        },
        r = async () => {
          window.addEventListener("message", (e) => {
            if (e.data) {
              let i = e.data;
              if ("embed-player" !== i.source) return;
              i.uuid ||
                (u(),
                this.instances.forEach((e) => {
                  !e._isIframeConnected &&
                    e.iframe &&
                    a(
                      {
                        action: "uuid",
                        uuid: e.uuid,
                        autoplay: e.isInViewport(),
                      },
                      e.iframe
                    );
                }));
              let s = this.instances.find((e) => e.uuid === i.uuid);
              if (s)
                switch (((s._isIframeConnected = !0), i.event)) {
                  case "user:play":
                    (s.isUserPaused = !1), (s._isPaused = !1);
                    break;
                  case "play":
                    s.isInViewport()
                      ? (this.activePlayer &&
                          this.activePlayer !== s &&
                          this.activePlayer.pause(),
                        (this.activePlayer = s))
                      : s.pause(),
                      (s._isPaused = !1);
                    break;
                  case "user:pause":
                    s.isUserPaused = !0;
                  case "pause":
                    (s._isPaused = !0), (this.activePlayer = null);
                    break;
                  case "timeupdate":
                    (s._isPaused = i.state.paused),
                      s.isPaused() ||
                        !s.playOnlyWhenVisible ||
                        s.isInViewport() ||
                        (s.pause(), (this.activePlayer = null));
                    break;
                  case "resize-area":
                    !(function e(i, s) {
                      if ("hide" === s.playerVisible) {
                        "0px" !== i.iframe.style.height &&
                          (i.iframe.style.height = "0px");
                        return;
                      }
                      if (s.isEmulatedFullScreen) {
                        (i.isEmulatedFullScreen = !0),
                          (i.originalStyles = n(i.iframe, {
                            width: "100vw",
                            height: "100vh",
                            position: "absolute",
                            zIndex: "1000",
                            top: "0",
                            left: "0",
                            right: "0",
                            bottom: "0",
                            border: "none",
                            borderRadius: "0",
                          }));
                        return;
                      }
                      if (
                        (i.isEmulatedFullScreen &&
                          ((i.isEmulatedFullScreen = !1),
                          n(i.iframe, i.originalStyles)),
                        s.isMobile && s.isEmbedMode)
                      ) {
                        let t = s.productDrawer
                            ? s.productDrawerHeight || 73
                            : 0,
                          a = s.chat ? s.chatHeight || 200 : 0,
                          l = i.iframe.getBoundingClientRect();
                        s.state.isVertical
                          ? (i.iframe.style.height =
                              parseInt(l.width) * (16 / 9) + "px")
                          : (i.iframe.style.height =
                              parseInt(l.width) * (9 / 16) + t + a + "px");
                      } else
                        "0px" === i.iframe.style.height &&
                          (i.iframe.style.height = i.originalHeight);
                    })(s, i);
                }
            }
          }),
            u();
        },
        u = () => {
          document.querySelectorAll("iframe").forEach((e) => {
            if (!this.instances.find((i) => i.iframe === e)) {
              let i = {
                _isPaused: !0,
                _isIframeConnected: !1,
                playOnlyWhenVisible: !0,
                isUserPaused: !1,
                uuid: Math.random().toString(36).substring(7),
                iframe: e,
                origin: e.src.split("/").slice(0, 3).join("/"),
                originalHeight: e.height,
                originalWidth: e.width,
                originalStyles: {},
                play() {
                  a({ action: "play", uuid: i.uuid }, e);
                },
                pause() {
                  a({ action: "pause", uuid: i.uuid }, e);
                },
                isPaused: () => i._isPaused,
                isInViewport: () => t(e),
              };
              this.instances.push(i);
            }
          });
        };
      l(), r();
      let p,
        o =
          ((e = function e() {
            i.instances.forEach((e) => {
              !e.playOnlyWhenVisible ||
                e.isUserPaused ||
                (s(
                  "[handleScroll]",
                  e,
                  e.isInViewport(),
                  e.isInViewport() && e.isPaused(),
                  !e.isPaused() && !e.isInViewport()
                ),
                e.isInViewport() && e.isPaused()
                  ? e.play()
                  : e.isPaused() || e.isInViewport() || e.pause());
            });
          }),
          function i(...s) {
            let t = () => {
              clearTimeout(p), e(...s);
            };
            clearTimeout(p), (p = setTimeout(t, 100));
          });
      document.addEventListener("scroll", o, { passive: !0 });
    })();
  </script>
</body>
